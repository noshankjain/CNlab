#include <stdio.h>
#include <string.h>

#define FLAG 'F' // Frame delimiter character
#define ESC 'E'  // Escape character

int main() {
    char input[100];
    char stuffed[200];
    char destuffed[100];
    int i, j;

    printf("Enter binary value: ");
    fgets(input, sizeof(input), stdin);
    input[strcspn(input, "\n")] = '\0'; // Remove trailing newline

    // Character stuffing
    j = 0;
    stuffed[j++] = FLAG; // Add starting flag
    for (i = 0; i < strlen(input); i++) {
        if (input[i] == FLAG || input[i] == ESC) {
            stuffed[j++] = ESC; // Insert escape character
        }
        stuffed[j++] = input[i]; // Copy the character
    }
    stuffed[j++] = FLAG; // Add ending flag
    stuffed[j] = '\0';

    // Output after appending delimiters
    printf("\nAppending delimiters: %c%s%c\n", FLAG, input, FLAG);

    // Output stuffed string
    printf("After stuffing: %s\n", stuffed);

    // Character destuffing
    j = 0;
    for (i = 1; i < strlen(stuffed) - 1; i++) { // Skip flags
        if (stuffed[i] == ESC) {
            i++; // Skip ESC, take next character
        }
        destuffed[j++] = stuffed[i];
    }
    destuffed[j] = '\0';

    // Output destuffed string
    printf("Destuffing: %s\n", destuffed);

    return 0;
}
